<!DOCTYPE html>
<html>
    <head>
        <link href='https://fonts.googleapis.com/css?family=Afacad' rel='stylesheet'>
        <link rel="stylesheet" href="styles/login.css">
    </head>
    
    <body>
        <img src="/konc2.jpeg" alt="Fonas" id="background-image" />
        <div id="header-bar" id="center-title">TICKET LIVE</div>
        <div id="dark-box">
            <h2>Log in</h2>
            <form id="loginForm">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" placeholder="Enter your username" required>

                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter your password" required>

                <button type="submit">Done</button>
                <p id="errorMsg" style="color: red;"></p>
            </form>

            <a id="login-corner-btn" href="admin.html">Admin</a>
        </div>
        <script>
            document.getElementById("loginForm").addEventListener("submit", function (event) {
             event.preventDefault();

             const userName = document.getElementById("username").value;
             const password = document.getElementById("password").value;
             const errorMsg = document.getElementById("errorMsg");

             errorMsg.textContent = "";

             fetch("http://localhost:3000/users/login", {
                 method: "POST",
                 headers: {
                     "Content-Type": "application/json"
                 },
                 body: JSON.stringify({ userName, password })
             })
             .then(response => {
                 if (response.ok) {
                     window.location.href = "logedin.html";
                 } else {
                     return response.text().then(text => {
                         errorMsg.textContent = text;
                     });
                 }
             })
             .catch(error => {
                 console.error("Error:", error);
                 errorMsg.textContent = "Server error. Please try again.";
             });
         });
        </script>
    </body>
    <div id="footer-bar">©2025 GABRIELĖ GERMANTĖ NIKITA INEDA PI23A</div>
</html>
