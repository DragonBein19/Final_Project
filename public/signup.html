<!DOCTYPE html>
<html>
<head>
    <link href='https://fonts.googleapis.com/css?family=Afacad' rel='stylesheet'>
    <link rel="stylesheet" href="styles/signup.css">
    <title>Sign up</title>
</head>

<body>
    <img src="/konc2.jpeg" alt="Fonas" id="background-image" />

    <div id="header-bar" id="center-title">TICKET LIVE</div>

    <div id="dark-box">
        <h2>Sign up</h2>
        <form id="signForm">
            <label for="username">Username</label>
            <input type="text" id="username" name="username" placeholder="Enter your username" required>

            <label for="name">Name</label>
            <input type="text" id="name" name="name" placeholder="Enter your name" required>

            <label for="surname">Surname</label>
            <input type="text" id="surname" name="surname" placeholder="Enter your surname" required>

            <label for="email">Email</label>
            <input type="email" id="email" name="email" placeholder="Enter your email" required>

            <label for="phone">Phone</label>
            <input type="tel" id="phone" name="phone" placeholder="Enter your phone number" required>

            <label for="password">Password</label>
            <input type="password" id="password" name="password" placeholder="Enter your password" required>

            <p id="errorMsg" style="color: red;"></p>

            <button type="submit">Done</button>
        </form>          
    </div>
</body>
    <script>
        document.getElementById("signForm").addEventListener("submit", function(event) {
        event.preventDefault();

        const password = document.getElementById("password").value;
        const passwordRegex = /^(?=.*[A-Z])(?=.*\d).{8,}$/;

        if (!passwordRegex.test(password)) {
            document.getElementById("errorMsg").textContent = 
            "Password should be at least 8 simbols long, capital letter and numbers.";
            return;
        } else {
            document.getElementById("errorMsg").textContent = "";
        }

        const user = {
            userName: document.getElementById("username").value,
            name: document.getElementById("name").value,
            surname: document.getElementById("surname").value,
            email: document.getElementById("email").value,
            phone: document.getElementById("phone").value,
            password: password
        };

        fetch("http://localhost8080/users/register", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(user)
        })
        .then(response => {
            if (response.ok) {
                window.location.href = "succesful.html";
            } else {
                return response.text().then(text => {
                    document.getElementById("errorMsg").textContent = text;
                });
            }
        })
        .catch(error => {
            console.error("Error:", error);
            document.getElementById("errorMsg").textContent = "Server error. Try again.";
        });
    });
    document.getElementById("signForm").addEventListener("submit", function(event) {
        event.preventDefault();

        const password = document.getElementById("password").value;
        const passwordRegex = /^(?=.*[A-Z])(?=.*\d).{8,}$/;

        if (!passwordRegex.test(password)) {
            document.getElementById("errorMsg").textContent = 
            "Password should be at least 8 simbols long, capital letter and numbers.";
            return;
        } else {
            document.getElementById("errorMsg").textContent = "";
        }

        const user = {
            userName: document.getElementById("username").value,
            name: document.getElementById("name").value,
            surname: document.getElementById("surname").value,
            email: document.getElementById("email").value,
            phone: document.getElementById("phone").value,
            password: password
        };

        fetch("http://localhost:8080/users/register", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(user)
        })
        .then(response => {
            if (response.ok) {
                window.location.href = "succesful.html";
            } else {
                return response.text().then(text => {
                    document.getElementById("errorMsg").textContent = text;
                });
            }
        })
        .catch(error => {
            console.error("Error:", error);
            document.getElementById("errorMsg").textContent = "Server error. Try again.";
        });
    });

    </script>
<div id="footer-bar">©2025 GABRIELĖ GERMANTĖ NIKITA INEDA PI23A</div>
</html>
